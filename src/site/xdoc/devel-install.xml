<?xml version="1.0" encoding="UTF-8"?>
<document xmlns="http://maven.apache.org/XDOC/2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/XDOC/2.0 http://maven.apache.org/xsd/xdoc-2.0.xsd">
	<properties>
		<title>Installation Guide</title>
		<author>Yves Fischer</author>
		<date>24.02.2011</date>
	</properties>

	<body>
		<section name="Installation Guide">
			<subsection name="Mit Embedded Servlet Container">
				<source>mvn jetty:run</source>
				<p>Standardmäßig lauscht jetty nun auf Port 8080</p>
			</subsection>
			<subsection name="Mit .war File">
				<p>
					Ein Web-Archive (.war) kann mit dem Maven Kommando
					<tt>mvn package</tt>
					erzeugt werden.
				</p>
			</subsection>
		</section>
		<section name="Installation unter SLES 11.1">
			<p>
				Es muss ein halbwegs aktuelles Java-JDK installiert sein, dieses
				kann von
				<a href="http://java.sun.com">java.sun.com</a>
				für Linux/i386 heruntergeladen werden.
			</p>
			<p>
				Für die Ausführung von dhbwcalender wird ein neuer Benutzer
				mit Namen
				<tt>dhbwcalendar</tt>
				angelegt.
			</p>
			<p>
				maven2 wird von
				<a href="http://maven.apache.org">maven.apache.org</a>
				installiert in
				<tt>/home/dhbwcalendar/share/apache-maven-2.2.1/</tt>
			</p>
			<p>
				Für den Benutzer dhbwcalendar wird in seiner
				<tt>.profile</tt>
				Datei die Umgebungsvariablen
				<tt>JAVA_HOME</tt>
				,
				<tt>M2_HOME</tt>
				(maven) entsprechend gesetzt
			</p>
			<p>
				git wird mit zypper installiert:
				<source># zypper ar \
					"http://download.opensuse.org/repositories/devel:/tools:/scm/SLE_11/devel:tools:scm.repo"
					# zypper install git
					# su -l dhbwcalendar
					$ git clone ....</source>
			</p>
			<p>
				Da im produktiven Setup jetty nicht von "aussen" erreichbar sein
				soll wird jetty konfiguriert nur auf
				<i>localhost</i>
				zu horchen.
				<source>
					&lt;connectors&gt;
					&lt;connector
					implementation=&quot;org.mortbay.jetty.nio.SelectChannelConnector&quot;&gt;
					&lt;port&gt;8080&lt;/port&gt;
					&lt;host&gt;127.0.0.1&lt;/host&gt;
					&lt;/connector&gt;
					&lt;/connectors&gt;</source>
			</p>
			<p>
				Bei vaadin wird der
				<i>productionMode</i>
				aktiviert
				<tt>src/main/webapp/WEB-INF/web.xml:</tt>
				<source>
					&lt;context-param&gt;
					&lt;param-name&gt;productionMode&lt;/param-name&gt;
					&lt;param-value&gt;true&lt;/param-value&gt;
					&lt;description&gt;Vaadin production mode&lt;/description&gt;
					&lt;/context-param&gt;</source>
			</p>
			<p>
				<tt>mvn jetty:run</tt>
				startet Jetty über Maven als embedded Servlet Container.
			</p>
			<subsection name="SSL">
				<p>Zertifikat erstellen:</p>
				<source>
					% keytool -keystore keystore -alias jetty -genkey -keyalg RSA
					Geben Sie das
					Keystore-Passwort ein:
					Geben Sie das Passwort erneut ein:
					Wie lautet
					Ihr Vor- und Nachname?
					[Unknown]: dualical.ba-horb.de (ACHTUNG Common-Name = Hostname!)
					Wie lautet der Name
					Ihrer organisatorischen
					Einheit?
					[Unknown]: DHBW Stuttgart Campus
					Horb
					Wie lautet der Name
					Ihrer Organisation?
					[Unknown]: Duale
					Hochschule Baden-W&uuml;rttemberg
					Wie lautet der Name Ihrer Stadt oder Gemeinde?
					[Unknown]: Horb
					Wie
					lautet der Name Ihres Bundeslandes oder Ihrer Provinz?
					[Unknown]:
					Baden-W&uuml;rttemberg
					Wie lautet der Landescode (zwei Buchstaben) f&uuml;r
					diese Einheit?
					[Unknown]: DE
					Ist CN=DHBW Calendar, OU=DHBW Stuttgart
					Campus Horb, O=Duale
					Hochschule Baden-W&uuml;rttemberg,
					L=Horb, ST=Baden-W&uuml;rttemberg,
					C=DE
					richtig?
					[Nein]: Ja

					Geben Sie das Passwort f&uuml;r
					&lt;jetty&gt; ein.
					(EINGABETASTE, wenn Passwort dasselbe wie f&uuml;r
					Keystore):
				</source>
				<p>SSL für Jetty konfigurieren:</p>
				<source>
&lt;configuration&gt;
	&lt;connectors&gt;
		&lt;connector implementation=&quot;org.mortbay.jetty.nio.SelectChannelConnector&quot;&gt;
			&lt;port&gt;8080&lt;/port&gt;
		&lt;/connector&gt;
		&lt;connector implementation=&quot;org.mortbay.jetty.ssl.SslSelectChannelConnector&quot;&gt;
			&lt;port&gt;8443&lt;/port&gt;
			&lt;keystore&gt;${basedir}/server.keystore&lt;/keystore&gt;
			&lt;keyPassword&gt;bla&lt;/keyPassword&gt;
			&lt;password&gt;bla&lt;/password&gt;
		&lt;/connector&gt;
	&lt;/connectors&gt;
&lt;/configuration&gt;
	&lt;dependencies&gt;
		&lt;dependency&gt;
			&lt;groupId&gt;org.mortbay.jetty&lt;/groupId&gt;
			&lt;artifactId&gt;jetty-ssl&lt;/artifactId&gt;
			&lt;version&gt;7.0.0.pre5&lt;/version&gt;
		&lt;/dependency&gt;
	&lt;/dependencies&gt;
				</source>
				<p>Fingerprint von Zertifikat:</p>
				<source>
% keytool -list -keystore server.keystore -rfc
Geben Sie das Keystore-Passwort ein:

Keystore-Typ: JKS
Keystore-Provider: SUN

Ihr Keystore enth&auml;lt 1 Eintrag/-&auml;ge.

jetty, 29.03.2011, PrivateKeyEntry,
Zertifikatsfingerabdruck (MD5): B6:CA:AF:1C:8C:B7:38:38:36:2A:30:3C:A5:C2:54:20

-----BEGIN CERTIFICATE-----
....
-----END CERTIFICATE-----
				</source>
				<p>Die Verbindung kann jetzt mit wget überprüft werden</p>
				<source>
wget --ca-certificate=certificate.pem  https://dualical.ba-horb.de:8443/dhbwcalendar/
				</source>
			</subsection>
		</section>
	</body>
</document>

